<h1>Hello</h1>
<span id="message-output"></span>

<select name="language" onchange="onChange(this)" id="language">
  <option value="en,English">English</option>
<option value="es,Spanish">Espa&ntilde;ol</option>
<option value="ko,Korean">한국어</option>
<option value="ja,Japanese">日本語</option>
<option value="nl,Dutch">Nederlandse</option>
<option value="pt,Portuguese">Portugues</option>
</select>


<div>

	<p class="_headerLine1_l00ku_243 Header_Line_1 update_lang">WELCOME TO</p>
<hgroup>
<h1 class="_headerLine2_l00ku_244 Header_Line_2 update_lang">#LEVISOPENCALL</h1>
</hgroup>
	
</div>


<script>
     var input = document.getElementById("language");
      var output = document.getElementById("message-output");
      var iframe = document.getElementById("P5W829");
      
      var channel = new MessageChannel();
      var port1 = channel.port1
      var all_languages_json = {};
      loadJSON("https://sokuratesu.github.io/shortstack_test/json_all_languages.txt", catch_json_text,'jsonp');
   
  
      // Handle messages received on port1
      function onMessage(e) {
        console.log("Github I'm onMessage");
        console.log("Github e");
        console.log(e);
        console.log("Github e.data");
        output.innerHTML = e.data;
        input = document.getElementById("language");
        input.value = "";
      }

   // Wait for the iframe to load
      // iframe.addEventListener("load", onLoad);
      // console.log("Github I'm here adding an event to the iFrame");


  function addPortToFrame(){
	  
			 onLoad();
		}

	function preAddPort(){
		iframe = document.getElementById("P5W829");
		setTimeout(addPortToFrame, 2000);
	}


      function onLoad() {
        // if(iframe == null){
        // iframe = document.getElementById("P5W829");
        // }
        console.log("Github I'm onLoad");
        // Listen for button clicks
        // input.addEventListener("change", onChange);
        // Listen for messages on port1
        port1.onmessage = onMessage;
        // Transfer port2 to the iframe
        iframe.contentWindow.postMessage("init", "*", [channel.port2]);
        console.log("Github iFrame Loaded");
      }

  // Post a message on port1 when the option changes
      function onChange(e) {
        console.log("Github I'm onChange");
        console.log("Github e");
        console.log(e);
        console.log("Github value");
        console.log(e.value);
        // e.preventDefault();
        console.log(port1);
        port1.postMessage(e.value);

	let sel = e.value.split(",");
    	update_languages_str_on_main_page(sel[1]);
	      
      }

	// loadJSON method to open the JSON file.
  function loadJSON(path, success, error) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          success(JSON.parse(xhr.responseText));
        }
        else {
          error(xhr);
        }
      }
    };
    xhr.open('GET', path, true);
    xhr.send();
  }

	function catch_json_text(Data)
  {
		all_languages_json = Data;

  }



function update_languages_str_on_main_page(lang_code_selected){
    let sel_lang_arr = all_languages_json[lang_code_selected]["Submission Page"];
    let matches = document.querySelectorAll(".update_lang");
    
    Object.entries(sel_lang_arr).forEach(([key, value]) => {
        let cur_key = key
      cur_key = cur_key.replace(/ /g, '_');
      
      let cur_el = document.querySelector(".update_lang."+cur_key);
      if(typeof cur_el !== 'undefined'){
        
        if(typeof cur_el.nodeName !== 'undefined'){
          switch(cur_el.nodeName){
            case "DIV":
              //search for the input
              cur_el.querySelector("input").placeholder = value;
              break;
            case "P":
            case "H1":
              cur_el.innerHTML = value;
              break;
          }
        }
      }
      });
  }

	
    </script>

<iframe allow="autoplay" onload="preAddPort()" sandbox="allow-modals allow-forms allow-scripts allow-same-origin allow-popups allow-top-navigation allow-top-navigation-by-user-activation allow-downloads allow-popups-to-escape-sandbox" id="P5W829" class="embed_frame" loading="lazy" src="https://m.shortstack.page/P5W829?embed=3&script=1" style="border:none;min-width:100%;height:1366px" allowpaymentrequest allowfullscreen data-hj-allow-iframe></iframe>
<script>!function(){var e=document.getElementById("campaign-embed-code");e||((e=document.createElement("SCRIPT")).src="https://d1m2uzvk8r2fcn.cloudfront.net/scripts/embed-code/20230927/embed.min.js",e.id="campaign-embed-code",document.body.appendChild(e))}()</script>


